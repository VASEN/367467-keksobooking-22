{"version":3,"sources":["webpack://keksobooking/./source/js/popup-card.js","webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/server-data.js","webpack://keksobooking/./source/js/error.js","webpack://keksobooking/./source/js/success.js","webpack://keksobooking/./source/js/map-form.js","webpack://keksobooking/./source/js/images.js","webpack://keksobooking/./source/js/ad-form.js","webpack://keksobooking/./source/js/page.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/data.js"],"names":["typeTranslateEngToRus","flat","bungalow","house","palace","advertisementTemplate","document","querySelector","content","createGuestsString","col","createRoomsString","hideElement","element","style","display","disableDOMElement","disabled","enableDOMElement","isEscEvent","evt","key","ICON","SIZE","ANCHOR","CENTER_COORDS","lat","lng","advertisementFormAddress","mapCanvas","map","window","L","setView","mainIcon","icon","iconUrl","iconSize","iconAnchor","advertisementIcon","positionMarker","marker","draggable","markersLayer","layerGroup","on","currentLatLng","target","getLatLng","value","toFixed","showMarkerList","advertisements","slice","forEach","advertisement","createMarker","addTo","item","location","bindPopup","newAdvertisement","cloneNode","nodeAvatar","nodeTitle","nodeAddress","nodePrice","nodeType","nodeCapacity","nodeTime","nodeFeatures","nodeDescriptions","nodePhotos","author","avatar","offer","address","checkin","checkout","descriptions","features","guests","photos","price","rooms","title","type","textContent","innerHTML","featureElement","createElement","classList","add","appendChild","addFeatures","index","photoElement","width","height","alt","src","addPhotos","createAdvertisement","URL","checkStatus","response","ok","statusText","status","Error","pageContent","newError","onErrorMessageEscKeydown","preventDefault","closeErrorMessage","body","overflow","removeEventListener","removeChild","showError","addEventListener","newSuccessMessage","onSuccessMessageEscKeydown","closeSuccessMessage","mapForm","disableMapForm","childNodes","FILE_TYPES","getImage","chooser","preview","files","filenames","i","length","push","name","toLowerCase","getFileNames","every","el","some","endsWith","readers","Array","reader","FileReader","createReaders","result","imgTag","append","readAsDataURL","readFiles","advertisementForm","advertisementFormTitle","advertisementFormType","advertisementFormPrice","advertisementFormCheckin","advertisementFormCheckout","advertisementFormRooms","advertisementFormCapacity","advertisementFormReset","avatarChooser","avatarPreview","housingImagesChooser","housingImagesPreview","typeConvertToPrice","roomsToGuests","1","2","3","100","capacityOptions","from","options","reloadPage","reset","setLatLng","addAdvertisementFormCapacityItems","validity","valueMissing","setCustomValidity","titleLength","tooShort","tooLong","reportValidity","min","placeholder","rangeUnderflow","rangeOverflow","max","number","hidden","includes","selected","sendSuccess","sendFail","onSuccess","onFail","FormData","fetch","method","then","catch","DEFAULT_TYPE","priceFilterValueToRange","low","middle","high","typeFilter","priceFilter","roomsFilter","guestsFilter","checkFilter","filter","filterValue","toString","checkFilters","isTypeCheck","isRoomsCheck","isGuestsCheck","isPriceCheck","isPriceInRange","checkPriceFilter","isFeaturesCheck","querySelectorAll","checkFeaturesFilter","center","getCenter","tileLayer","attribution","remove","activatePage","cb","_","debounce","clearLayers","useFilter","json"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const typeTranslateEngToRus = {\n  flat: 'Квартира',\n  bungalow: 'Бунгало',\n  house: 'Дом',\n  palace: 'Дворец',\n};\n\nconst advertisementTemplate = document.querySelector('#card')\n  .content\n  .querySelector('.popup');\n\nconst createGuestsString = (col) => {\n  if (col === 1) {\n    return `${col} гостя`;\n  } else {\n    return `${col} гостей`;\n  }\n};\n\nconst createRoomsString = (col) => {\n  if (col === 1) {\n    return `${col} комната`;\n  } else if (col >= 5) {\n    return `${col} комнат`;\n  } else {\n    return `${col} комнаты`;\n  }\n};\n\nconst addFeatures = (nodeFeatures, features) => {\n  nodeFeatures.innerHTML = '';\n  features.forEach((item) => {\n    const featureElement = document.createElement('li');\n    featureElement.classList.add('popup__feature',`popup__feature--${item}`);\n    nodeFeatures.appendChild(featureElement);\n  });\n};\n\nconst addPhotos = (nodePhotos, photos) => {\n  nodePhotos.innerHTML = '';\n  photos.forEach((item, index) => {\n    const photoElement = document.createElement('img');\n    photoElement.classList.add('popup__photo');\n    photoElement.width = 45;\n    photoElement.height = 40;\n    photoElement.alt = `Фотография жилья ${index}`;\n    photoElement.src = `${item}`;\n    nodePhotos.appendChild(photoElement);\n  });\n};\n\nconst hideElement = (element) => {\n  element.style.display = 'none';\n};\n\nconst createAdvertisement = (advertisement) => {\n  const newAdvertisement = advertisementTemplate.cloneNode(true);\n  const nodeAvatar = newAdvertisement.querySelector('.popup__avatar');\n  const nodeTitle = newAdvertisement.querySelector('.popup__title');\n  const nodeAddress = newAdvertisement.querySelector('.popup__text--address');\n  const nodePrice = newAdvertisement.querySelector('.popup__text--price');\n  const nodeType = newAdvertisement.querySelector('.popup__type');\n  const nodeCapacity = newAdvertisement.querySelector('.popup__text--capacity');\n  const nodeTime = newAdvertisement.querySelector('.popup__text--time');\n  const nodeFeatures = newAdvertisement.querySelector('.popup__features');\n  const nodeDescriptions = newAdvertisement.querySelector('.popup__description');\n  const nodePhotos = newAdvertisement.querySelector('.popup__photos');\n\n  const {\n    author: {\n      avatar,\n    },\n    offer: {\n      address,\n      checkin,\n      checkout,\n      descriptions,\n      features,\n      guests,\n      photos,\n      price,\n      rooms,\n      title,\n      type,\n    },\n  } = advertisement;\n  title ? nodeTitle.textContent = title : hideElement(nodeTitle);\n  address ? nodeAddress.textContent = address : hideElement(nodeAddress);\n  price ? nodePrice.innerHTML = `${price} <span>₽/ночь</span>` : hideElement(nodePrice);\n  type ? nodeType.textContent = typeTranslateEngToRus[type] : hideElement(type);\n  if (!rooms && !guests) {\n    hideElement(nodeCapacity);\n  } else if (!rooms) {\n    nodeCapacity.textContent = `Для ${createGuestsString(guests)}`;\n  } else if (!guests) {\n    nodeCapacity.textContent = `${createRoomsString(rooms)}`;\n  } else {\n    nodeCapacity.textContent = `${createRoomsString(rooms)} для ${createGuestsString(guests)}`;\n  }\n  if (!checkin && !checkout) {\n    hideElement(nodeTime);\n  } else {\n    nodeTime.textContent = `Заезд после ${checkin} выезд до ${checkout}`;\n  }\n  features ? addFeatures(nodeFeatures, features) : hideElement(nodeFeatures);\n  descriptions ? nodeDescriptions.textContent = descriptions : hideElement(nodeDescriptions);\n  photos ? addPhotos(nodePhotos, photos) : hideElement(nodePhotos);\n  avatar ? nodeAvatar.src = avatar : hideElement(nodeAvatar);\n\n  return newAdvertisement;\n}\n\nexport {createAdvertisement};\n","const FLOAT_LENGTH = 5;\n\nconst disableDOMElement = (element) => {\n  element.disabled = true;\n}\n\nconst enableDOMElement = (element) => {\n  element.disabled = false;\n}\n\nconst isEscEvent = (evt) => {\n  return evt.key === 'Esc' || evt.key === 'Escape';\n}\n\nexport {isEscEvent, disableDOMElement, enableDOMElement, FLOAT_LENGTH};\n","import {createAdvertisement} from './popup-card.js';\nimport {FLOAT_LENGTH} from './util.js';\n\nconst ICON = {\n  SIZE: [40, 40],\n  ANCHOR: [20, 40],\n};\n\nconst CENTER_COORDS = {\n  lat: 35.685,\n  lng: 139.7514,\n};\n\nconst ADVERTISEMENT_MARKERS_COUNT = 10;\nconst MAP_ZOOM = 10;\nconst advertisementFormAddress = document.querySelector('#address');\nconst mapCanvas = document.querySelector('#map-canvas');\n\nconst map = window.L.map('map-canvas')\n  .setView(CENTER_COORDS, MAP_ZOOM);\n\nconst mainIcon = window.L.icon({\n  iconUrl: 'img/main-pin.svg',\n  iconSize: ICON.SIZE,\n  iconAnchor: ICON.ANCHOR,\n});\n\nconst advertisementIcon = window.L.icon({\n  iconUrl: 'img/pin.svg',\n  iconSize: ICON.SIZE,\n  iconAnchor: ICON.ANCHOR,\n});\n\nconst positionMarker = window.L.marker(\n  CENTER_COORDS,\n  {\n    icon: mainIcon,\n    draggable: true,\n  },\n);\n\nlet markersLayer = window.L.layerGroup();\n\npositionMarker.on('move', (evt) => {\n  const currentLatLng = evt.target.getLatLng();\n  advertisementFormAddress.value = `${currentLatLng.lat.toFixed(FLOAT_LENGTH)}, ${currentLatLng.lng.toFixed(FLOAT_LENGTH)}`;\n});\n\nconst clearMarkers = () => {\n  markersLayer.clearLayers();\n};\n\nconst showMarkerList = (advertisements) => {\n  advertisements\n    .slice(0, ADVERTISEMENT_MARKERS_COUNT)\n    .forEach((advertisement) => createMarker(advertisement));\n  markersLayer.addTo(map);\n};\n\nconst createMarker = (item) => {\n  const advertisementMarker = window.L.marker(\n    [item.location.lat, item.location.lng],\n    {\n      icon: advertisementIcon,\n    },\n  );\n  advertisementMarker\n    .addTo(markersLayer)\n    .bindPopup(createAdvertisement(item));\n};\n\nexport {map, showMarkerList, clearMarkers, mapCanvas, positionMarker, CENTER_COORDS, MAP_ZOOM};\n","const URL = 'https://22.javascript.pages.academy/keksobooking';\nconst Method = {\n  GET: 'GET',\n  POST: 'POST',\n}\n\nconst checkStatus = (response) => {\n  if (response.ok) {\n    return response;\n  }\n  const {statusText, status} = response;\n  throw new Error(`${status} - ${statusText}`);\n}\n\nconst getData = (onSuccess, onFail) => {\n  fetch(`${URL}/data`)\n    .then(checkStatus)\n    .then((response) => response.json())\n    .then(onSuccess)\n    .catch(onFail);\n};\n\nconst sendData = (onSuccess, onFail, body) => {\n  fetch(`${URL}`, {method: Method.POST, body})\n    .then(checkStatus)\n    .then(onSuccess)\n    .catch(onFail);\n};\n\nexport {getData, sendData};\n","import {isEscEvent} from './util.js';\n\nconst pageContent = document.querySelector('main');\nconst errorTemplate = document.querySelector('#error').content.querySelector('.error');\nconst newError = errorTemplate.cloneNode(true);\n\nconst onErrorMessageEscKeydown = (evt) => {\n  if (isEscEvent(evt)) {\n    evt.preventDefault();\n    closeErrorMessage();\n  }\n};\n\nconst closeErrorMessage = () => {\n  document.body.style.overflow = 'visible';\n  newError.removeEventListener('click', closeErrorMessage);\n  pageContent.querySelector('.error__button').removeEventListener('click', closeErrorMessage);\n  document.removeEventListener('keydown', onErrorMessageEscKeydown);\n  pageContent.removeChild(pageContent.querySelector('.error'));\n};\n\nconst showError = () => {\n  document.body.style.overflow = 'hidden';\n  newError.addEventListener('click', closeErrorMessage);\n  newError.querySelector('.error__button').addEventListener('click', closeErrorMessage);\n  document.addEventListener('keydown', onErrorMessageEscKeydown);\n\n  pageContent.appendChild(newError);\n};\n\nexport {showError};\n","import {isEscEvent} from './util.js';\n\nconst pageContent = document.querySelector('main');\nconst successTemplate = document.querySelector('#success').content.querySelector('.success');\nconst newSuccessMessage = successTemplate.cloneNode(true);\n\n\nconst onSuccessMessageEscKeydown = (evt) => {\n  if (isEscEvent(evt)) {\n    evt.preventDefault();\n    closeSuccessMessage();\n  }\n};\n\nconst closeSuccessMessage = () => {\n  document.body.style.overflow = 'visible';\n  newSuccessMessage.removeEventListener('click', closeSuccessMessage);\n  document.removeEventListener('keydown', onSuccessMessageEscKeydown);\n  pageContent.removeChild(pageContent.querySelector('.success'));\n};\n\nconst showSuccess = () => {\n  document.body.style.overflow = 'hidden';\n  newSuccessMessage.addEventListener('click', closeSuccessMessage);\n  document.addEventListener('keydown', onSuccessMessageEscKeydown);\n\n  pageContent.appendChild(newSuccessMessage);\n};\n\nexport {showSuccess};\n","import {disableDOMElement, enableDOMElement} from './util.js';\n\nconst mapForm = document.querySelector('.map__filters');\n\nconst disableMapForm = () => {\n  mapForm.classList.add('map__filters--disabled');\n  mapForm.childNodes.forEach(disableDOMElement);\n};\n\nconst enableMapForm = () => {\n  mapForm.classList.remove('map__filters--disabled');\n  mapForm.childNodes.forEach(enableDOMElement);\n};\n\nconst setFilterForm = (cb) => {\n  mapForm.addEventListener('change', () => {\n    cb();\n  });\n}\n\nexport {disableMapForm, enableMapForm, setFilterForm, mapForm};\n","const FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\n\nconst getFileNames = (files) => {\n  const filenames = [];\n  for (let i = 0; i < files.length; i++) {\n    filenames.push(files[i].name.toLowerCase());\n  }\n  return filenames;\n};\n\nconst createReaders = (files) => {\n  const readers = new Array(files.length);\n  for (let i = 0; i < readers.length; i++) {\n    let reader = new FileReader();\n    readers[i] = reader;\n  }\n  return readers;\n};\n\nconst readFiles = (files, readers) => {\n  for (let i = 0; i < files.length; i++) {\n    readers[i].readAsDataURL(files[i]);\n  }\n};\n\nconst getImage = (chooser, preview) => {\n  const files = chooser.files;\n\n  let filenames = getFileNames(files);\n\n  let matches = filenames.every((el) => {\n    return FILE_TYPES.some((item) => {\n      return el.endsWith(item);\n    })\n  });\n  if (matches) {\n    let readers = createReaders(files);\n\n    readers.forEach((item) => {\n      item.addEventListener('load', () => {\n        if (!preview.src) {\n          let imgTag = document.createElement('img');\n          imgTag.src = item.result;\n          imgTag.width = 40;\n          imgTag.height = 44;\n          preview.append(imgTag);\n        } else {\n          preview.src = item.result;\n        }\n      })\n    })\n    readFiles(files, readers);\n  }\n};\n\nexport {getImage};\n","import {sendData} from './server-data.js';\nimport {disableDOMElement, enableDOMElement, FLOAT_LENGTH} from './util.js';\nimport {showError} from './error.js';\nimport {showSuccess} from './success.js';\nimport {CENTER_COORDS, map, MAP_ZOOM, positionMarker} from './map.js';\nimport {mapForm} from './map-form.js';\nimport {getImage} from './images.js';\n\nconst advertisementForm = document.querySelector('.ad-form');\nconst advertisementFormTitle = advertisementForm.querySelector('#title');\nconst advertisementFormAddress = advertisementForm.querySelector('#address');\nconst advertisementFormType = advertisementForm.querySelector('#type');\nconst advertisementFormPrice = advertisementForm.querySelector('#price');\nconst advertisementFormCheckin = advertisementForm.querySelector('#timein');\nconst advertisementFormCheckout = advertisementForm.querySelector('#timeout');\nconst advertisementFormRooms = advertisementForm.querySelector('#room_number');\nconst advertisementFormCapacity = advertisementForm.querySelector('#capacity');\nconst advertisementFormReset = advertisementForm.querySelector('.ad-form__reset');\n\nconst avatarChooser = advertisementForm.querySelector('#avatar');\nconst avatarPreview = advertisementForm.querySelector('.ad-form-header__preview img');\n\nconst housingImagesChooser = advertisementForm.querySelector('#images');\nconst housingImagesPreview = advertisementForm.querySelector('.ad-form__photo');\n\nconst typeConvertToPrice = {\n  flat: 1000,\n  bungalow: 0,\n  house: 5000,\n  palace: 10000,\n};\n\nconst roomsToGuests = {\n  1: ['1'],\n  2: ['1', '2'],\n  3: ['1', '2', '3'],\n  100: ['0'],\n};\n\nconst capacityOptions = Array.from(advertisementFormCapacity.options);\n\nconst disableAdvertisementForm = () => {\n  advertisementForm.classList.add('ad-form--disabled');\n  advertisementForm.childNodes.forEach(disableDOMElement);\n};\n\nconst enableAdvertisementForm = () => {\n  advertisementForm.classList.remove('ad-form--disabled');\n  advertisementForm.childNodes.forEach(enableDOMElement);\n  addAdvertisementFormCapacityItems(advertisementFormRooms.value);\n};\n\nconst reloadPage = () => {\n  advertisementForm.reset();\n  mapForm.reset();\n  map.setView(CENTER_COORDS, MAP_ZOOM);\n  positionMarker.setLatLng(CENTER_COORDS);\n  advertisementFormAddress.value = `${CENTER_COORDS.lat.toFixed(FLOAT_LENGTH)}, ${CENTER_COORDS.lng.toFixed(FLOAT_LENGTH)}`;\n  addAdvertisementFormCapacityItems(advertisementFormRooms.value);\n};\n\nadvertisementFormTitle.addEventListener('invalid', () => {\n  if (advertisementFormTitle.validity.valueMissing) {\n    advertisementFormTitle.setCustomValidity('Обязательное поле для заполнения!');\n  } else {\n    advertisementFormTitle.setCustomValidity('');\n  }\n})\n\nadvertisementFormTitle.addEventListener('input', () => {\n  const titleLength = advertisementFormTitle.value.length;\n  if (advertisementFormTitle.validity.tooShort) {\n    advertisementFormTitle.setCustomValidity(`Длинна заголовка не менее 30 символов (${titleLength}/30)`);\n  } else if (advertisementFormTitle.validity.tooLong) {\n    advertisementFormTitle.setCustomValidity('Длинна заголовка не более 100 символов');\n  } else if (advertisementFormTitle.validity.valueMissing) {\n    advertisementFormTitle.setCustomValidity('Обязательное поле для заполнения!');\n  } else {\n    advertisementFormTitle.setCustomValidity('');\n  }\n  advertisementFormTitle.reportValidity();\n});\n\nadvertisementFormType.addEventListener('change', () => {\n  advertisementFormPrice.min = typeConvertToPrice[advertisementFormType.value];\n  advertisementFormPrice.placeholder = typeConvertToPrice[advertisementFormType.value];\n});\n\nadvertisementFormPrice.addEventListener('change', () => {\n  if (advertisementFormPrice.validity.rangeUnderflow) {\n    advertisementFormPrice.setCustomValidity(`Стоимость должна быть выше ${advertisementFormPrice.placeholder}`);\n  } else if (advertisementFormPrice.validity.rangeOverflow) {\n    advertisementFormPrice.setCustomValidity(`Стоимость должна быть ниже ${advertisementFormPrice.max}`);\n  } else if (advertisementFormPrice.validity.valueMissing) {\n    advertisementFormPrice.setCustomValidity('Обязательное поле для заполнения!');\n  } else {\n    advertisementFormPrice.setCustomValidity('');\n  }\n  advertisementFormPrice.reportValidity();\n});\n\nadvertisementFormCheckin.addEventListener('change', () => {\n  advertisementFormCheckout.value = advertisementFormCheckin.value;\n});\n\nadvertisementFormCheckout.addEventListener('change', () => {\n  advertisementFormCheckin.value = advertisementFormCheckout.value;\n});\n\nconst addAdvertisementFormCapacityItems = (number) => {\n  capacityOptions.forEach((item) => {\n    item.hidden = !roomsToGuests[number].includes(item.value);\n    item.selected = !item.hidden;\n  })\n};\n\nadvertisementFormRooms.addEventListener('change', () => {\n  addAdvertisementFormCapacityItems(advertisementFormRooms.value);\n});\n\nadvertisementFormReset.addEventListener('click', (evt) => {\n  evt.preventDefault();\n  reloadPage();\n});\n\nconst sendSuccess = () => {\n  reloadPage();\n  showSuccess();\n};\n\nconst sendFail = () => {\n  showError('Ошибка отправки формы!');\n};\n\nadvertisementForm.addEventListener('submit', (evt) => {\n  evt.preventDefault();\n  sendData(\n    sendSuccess,\n    sendFail,\n    new FormData(evt.target),\n  )\n});\n\navatarChooser.addEventListener('change', () => {\n  getImage(avatarChooser, avatarPreview);\n});\n\nhousingImagesChooser.addEventListener('change', () => {\n  getImage(housingImagesChooser, housingImagesPreview);\n})\n\nexport {advertisementForm, advertisementFormAddress, disableAdvertisementForm, enableAdvertisementForm};\n","import {map, mapCanvas, positionMarker} from './map.js';\nimport {advertisementFormAddress, disableAdvertisementForm, enableAdvertisementForm} from './ad-form.js';\nimport {disableMapForm, enableMapForm} from './map-form.js';\nimport {FLOAT_LENGTH} from './util.js';\n\nconst activatePage = () => {\n  const center = map.getCenter();\n  window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n    {\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n    },\n  ).addTo(map);\n  positionMarker.addTo(map);\n  mapCanvas.childNodes.forEach(item => item.hidden = false);\n  enableAdvertisementForm();\n  enableMapForm();\n  advertisementFormAddress.value = `${center.lat.toFixed(FLOAT_LENGTH)}, ${center.lng.toFixed(FLOAT_LENGTH)}`;\n}\n\nconst deactivatePage = () => {\n  mapCanvas.childNodes.forEach(item => item.hidden = true);\n  disableAdvertisementForm();\n  disableMapForm();\n}\n\nexport {activatePage, deactivatePage};\n","const DEFAULT_TYPE = 'any';\n\nconst priceFilterValueToRange = {\n  low: {min: 0, max: 10000},\n  middle: {min: 10000, max: 50000},\n  high: {min: 50000, max: 1000000},\n}\n\nconst mapForm = document.querySelector('.map__filters');\nconst typeFilter = mapForm.querySelector('#housing-type');\nconst priceFilter = mapForm.querySelector('#housing-price');\nconst roomsFilter = mapForm.querySelector('#housing-rooms');\nconst guestsFilter = mapForm.querySelector('#housing-guests');\n\nconst isPriceInRange = (price, filterValue) => {\n  return (price >= priceFilterValueToRange[filterValue].min && price < priceFilterValueToRange[filterValue].max)\n}\n\nconst checkFilter = (item, filter, filterValue) => {\n  if (filterValue === DEFAULT_TYPE) {\n    return true;\n  }\n  return item.offer[filter].toString() === (filterValue || DEFAULT_TYPE);\n}\n\nconst checkPriceFilter = (item, filterValue) => {\n  if (filterValue === DEFAULT_TYPE) {\n    return true;\n  }\n  return isPriceInRange(item.offer.price, filterValue);\n}\n\nconst checkFeaturesFilter = (item) => {\n  let features = Array.from(mapForm.querySelectorAll('input[type=checkbox]:checked'));\n  if (!features.length) {\n    return true;\n  }\n\n  return features.every((el) => item.offer.features.includes(el.value));\n}\n\nconst checkFilters = (item) => {\n  const isTypeCheck = checkFilter(item,  'type', typeFilter.value);\n  const isRoomsCheck = checkFilter(item, 'rooms', roomsFilter.value);\n  const isGuestsCheck = checkFilter(item, 'guests', guestsFilter.value);\n  const isPriceCheck = checkPriceFilter(item, priceFilter.value);\n  const isFeaturesCheck = checkFeaturesFilter(item);\n  return isTypeCheck && isRoomsCheck && isGuestsCheck && isPriceCheck && isFeaturesCheck;\n};\n\nconst useFilter = (advertisements) => {\n  return advertisements.filter(checkFilters);\n}\n\nexport {useFilter};\n","/* global _:readonly */\nimport {clearMarkers, map, showMarkerList} from './map.js';\nimport {getData} from './server-data.js';\nimport {activatePage, deactivatePage} from './page.js';\nimport {disableMapForm} from './map-form.js';\nimport {showError} from './error.js';\nimport {setFilterForm} from './map-form.js';\nimport {useFilter} from './filter.js';\n\nconst CREATE_MARKERS_DELAY = 500;\n\nconst getDataSuccess = (advertisements) => {\n  showMarkerList(advertisements);\n  setFilterForm(_.debounce(() => {\n    clearMarkers();\n    showMarkerList(useFilter(advertisements));\n  }), CREATE_MARKERS_DELAY);\n};\n\nconst getDataFailure = () => {\n  disableMapForm();\n  showError('Не удалось загрузить предложения!');\n}\n\nif (map) {\n  activatePage();\n  getData(getDataSuccess, getDataFailure);\n} else {\n  deactivatePage();\n}\n"],"sourceRoot":""}